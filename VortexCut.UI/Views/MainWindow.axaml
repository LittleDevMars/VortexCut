<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:vm="clr-namespace:VortexCut.UI.ViewModels"
        xmlns:views="clr-namespace:VortexCut.UI.Views"
        xmlns:controls="clr-namespace:VortexCut.UI.Controls"
        xmlns:timeline="clr-namespace:VortexCut.UI.Controls.Timeline"
        mc:Ignorable="d" d:DesignWidth="1600" d:DesignHeight="900"
        x:Class="VortexCut.UI.Views.MainWindow"
        x:DataType="vm:MainViewModel"
        Title="VortexCut - Professional Video Editor"
        Width="1600" Height="900"
        MinWidth="1024" MinHeight="600">

    <DockPanel LastChildFill="True">
        <!-- Menu Bar -->
        <Menu DockPanel.Dock="Top">
            <MenuItem Header="íŒŒì¼">
                <MenuItem Header="ìƒˆ í”„ë¡œì íŠ¸" Command="{Binding CreateNewProjectCommand}" />
                <MenuItem Header="ë¹„ë””ì˜¤ ê°€ì ¸ì˜¤ê¸°" Command="{Binding OpenVideoFileCommand}" />
                <MenuItem Header="ì €ìž¥" />
                <Separator />
                <MenuItem Header="ë‚´ë³´ë‚´ê¸°" />
                <Separator />
                <MenuItem Header="ì¢…ë£Œ" />
            </MenuItem>
            <MenuItem Header="íŽ¸ì§‘">
                <MenuItem Header="ì‹¤í–‰ ì·¨ì†Œ (Ctrl+Z)" />
                <MenuItem Header="ë‹¤ì‹œ ì‹¤í–‰ (Ctrl+Y)" />
                <Separator />
                <MenuItem Header="ë¶„í•  (S)" />
                <MenuItem Header="ì‚­ì œ (Del)" />
            </MenuItem>
            <MenuItem Header="ë³´ê¸°">
                <MenuItem Header="Project Bin" />
                <MenuItem Header="íƒ€ìž„ë¼ì¸" />
                <MenuItem Header="Effects" />
            </MenuItem>
        </Menu>

        <!-- Main Content -->
        <Grid>
            <Grid.RowDefinitions>
                <!-- Top: Project Bin + Monitors + Effects -->
                <RowDefinition Height="2*" />
                <RowDefinition Height="5" />
                <!-- Bottom: Timeline -->
                <RowDefinition Height="*" />
            </Grid.RowDefinitions>

            <!-- Top Area -->
            <Grid Grid.Row="0">
                <Grid.ColumnDefinitions>
                    <!-- Project Bin -->
                    <ColumnDefinition Width="300" MinWidth="200" />
                    <ColumnDefinition Width="5" />
                    <!-- Monitors (Clip + Project) -->
                    <ColumnDefinition Width="3*" MinWidth="400" />
                    <ColumnDefinition Width="5" />
                    <!-- Effects/Properties -->
                    <ColumnDefinition Width="300" MinWidth="200" />
                </Grid.ColumnDefinitions>

                <!-- Project Bin -->
                <views:ProjectBinView Grid.Column="0"
                                      DataContext="{Binding ProjectBin}" />

                <GridSplitter Grid.Column="1" Background="#444" ResizeDirection="Columns" />

                <!-- Dual Monitors Area -->
                <Grid Grid.Column="2">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="5" />
                        <ColumnDefinition Width="*" />
                    </Grid.ColumnDefinitions>

                    <!-- Clip Monitor -->
                    <Border Grid.Column="0" Background="#1E1E1E">
                        <DockPanel>
                            <!-- Header -->
                            <Border DockPanel.Dock="Top" Background="#2D2D30" Padding="10,5">
                                <TextBlock Text="Clip Monitor"
                                           Foreground="White"
                                           FontSize="14"
                                           FontWeight="Bold"/>
                            </Border>

                            <!-- Preview -->
                            <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center">
                                <Border Background="Black" Margin="10">
                                    <Image Width="400" Height="225"
                                           Stretch="Uniform" />
                                </Border>
                            </StackPanel>
                        </DockPanel>
                    </Border>

                    <GridSplitter Grid.Column="1" Background="#444" ResizeDirection="Columns" />

                    <!-- Project Monitor -->
                    <Border Grid.Column="2" Background="#1E1E1E">
                        <DockPanel>
                            <!-- Header -->
                            <Border DockPanel.Dock="Top" Background="#2D2D30" Padding="10,5">
                                <TextBlock Text="Project Monitor"
                                           Foreground="White"
                                           FontSize="14"
                                           FontWeight="Bold"/>
                            </Border>

                            <!-- Preview -->
                            <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center">
                                <Border Background="Black" Margin="10">
                                    <Image Source="{Binding Preview.PreviewImage}"
                                           Width="400" Height="225"
                                           Stretch="Uniform" />
                                </Border>

                                <!-- Playback Controls -->
                                <StackPanel Orientation="Horizontal"
                                            HorizontalAlignment="Center"
                                            Margin="0,10,0,0">
                                    <Button Content="â®" Width="40" Margin="2" />
                                    <Button Content="âª" Width="40" Margin="2" />
                                    <Button Content="â–¶" Width="40" Margin="2"
                                            Command="{Binding PlayPauseCommand}" />
                                    <Button Content="â©" Width="40" Margin="2" />
                                    <Button Content="â­" Width="40" Margin="2" />
                                    <Button Content="â¹" Width="40" Margin="2" />
                                </StackPanel>

                                <!-- Timecode -->
                                <TextBlock Text="{Binding Preview.CurrentTimeMs, StringFormat='{}{0} ms'}"
                                           Foreground="LightGray"
                                           FontSize="14"
                                           FontFamily="Consolas"
                                           HorizontalAlignment="Center"
                                           Margin="0,10,0,0"/>
                            </StackPanel>
                        </DockPanel>
                    </Border>
                </Grid>

                <GridSplitter Grid.Column="3" Background="#444" ResizeDirection="Columns" />

                <!-- Effects/Properties Panel -->
                <Border Grid.Column="4" Background="#252526">
                    <DockPanel>
                        <Border DockPanel.Dock="Top" Background="#2D2D30" Padding="10,5">
                            <TextBlock Text="Properties / Effects"
                                       Foreground="White"
                                       FontSize="14"
                                       FontWeight="Bold"/>
                        </Border>

                        <ScrollViewer>
                            <StackPanel Margin="10">
                                <TextBlock Text="í´ë¦½ ì†ì„±"
                                           Foreground="White"
                                           FontSize="12"
                                           FontWeight="SemiBold"
                                           Margin="0,0,0,10"/>

                                <TextBlock Text="ì„ íƒëœ í´ë¦½ ì—†ìŒ"
                                           Foreground="Gray"
                                           FontSize="11" />

                                <Separator Margin="0,20,0,10" Background="#444" />

                                <TextBlock Text="Effects"
                                           Foreground="White"
                                           FontSize="12"
                                           FontWeight="SemiBold"
                                           Margin="0,0,0,10"/>

                                <ListBox Background="Transparent">
                                    <ListBoxItem Content="Transform" />
                                    <ListBoxItem Content="Color Correction" />
                                    <ListBoxItem Content="Blur" />
                                    <ListBoxItem Content="Fade In/Out" />
                                </ListBox>
                            </StackPanel>
                        </ScrollViewer>
                    </DockPanel>
                </Border>
            </Grid>

            <!-- Splitter -->
            <GridSplitter Grid.Row="1" Background="#444" ResizeDirection="Rows" />

            <!-- Timeline Area with Graph Editor -->
            <Border Grid.Row="2" Background="#1E1E1E">
                <Grid>
                    <Grid.RowDefinitions>
                        <!-- Timeline -->
                        <RowDefinition Height="2*" MinHeight="200" />
                        <RowDefinition Height="5" />
                        <!-- Graph Editor -->
                        <RowDefinition Height="*" MinHeight="150" />
                    </Grid.RowDefinitions>

                    <!-- Timeline -->
                    <DockPanel Grid.Row="0">
                        <!-- Timeline Toolbar -->
                        <Border DockPanel.Dock="Top" Background="#2D2D30" Padding="5">
                            <StackPanel Orientation="Horizontal" Spacing="10">
                                <TextBlock Text="Timeline"
                                           Foreground="White"
                                           FontSize="14"
                                           FontWeight="Bold"
                                           VerticalAlignment="Center"
                                           Margin="5,0"/>

                                <Separator Width="1" Background="#555" />

                                <Button Content="ðŸ”+" Width="35" ToolTip.Tip="Zoom In" />
                                <Button Content="ðŸ”-" Width="35" ToolTip.Tip="Zoom Out" />

                                <Separator Width="1" Background="#555" />

                                <ToggleButton Content="ðŸ§²" Width="35" ToolTip.Tip="Snap" />
                                <ToggleButton Content="âœ‚" Width="35" ToolTip.Tip="Razor Tool" />

                                <Separator Width="1" Background="#555" />

                                <TextBlock Text="Clips:"
                                           Foreground="LightGray"
                                           VerticalAlignment="Center" />
                                <TextBlock Text="{Binding Timeline.Clips.Count}"
                                           Foreground="White"
                                           VerticalAlignment="Center" />
                            </StackPanel>
                        </Border>

                        <!-- Timeline Canvas -->
                        <ScrollViewer HorizontalScrollBarVisibility="Auto"
                                      VerticalScrollBarVisibility="Auto">
                            <controls:TimelineCanvas x:Name="TimelineCanvas"
                                                     Width="2000"
                                                     Height="400" />
                        </ScrollViewer>
                    </DockPanel>

                    <GridSplitter Grid.Row="1" Background="#444" ResizeDirection="Rows" />

                    <!-- Graph Editor -->
                    <Border Grid.Row="2" Background="#1E1E1E">
                        <DockPanel>
                            <!-- Graph Editor Toolbar -->
                            <Border DockPanel.Dock="Top" Background="#2D2D30" Padding="5">
                                <StackPanel Orientation="Horizontal" Spacing="10">
                                    <TextBlock Text="Graph Editor"
                                               Foreground="White"
                                               FontSize="14"
                                               FontWeight="Bold"
                                               VerticalAlignment="Center"
                                               Margin="5,0"/>

                                    <Separator Width="1" Background="#555" />

                                    <ComboBox Width="120"
                                              SelectedIndex="{Binding Timeline.SelectedKeyframeSystem, Mode=TwoWay}"
                                              ToolTip.Tip="Keyframe System">
                                        <ComboBoxItem Content="Opacity" />
                                        <ComboBoxItem Content="Volume" />
                                        <ComboBoxItem Content="Position X" />
                                        <ComboBoxItem Content="Position Y" />
                                        <ComboBoxItem Content="Scale" />
                                        <ComboBoxItem Content="Rotation" />
                                    </ComboBox>

                                    <Separator Width="1" Background="#555" />

                                    <Button Content="Smooth" Width="60" ToolTip.Tip="Smooth Keyframes" />
                                    <Button Content="Linear" Width="60" ToolTip.Tip="Linearize Keyframes" />

                                    <Separator Width="1" Background="#555" />

                                    <Button Content="Fit" Width="50" ToolTip.Tip="Fit View" />
                                </StackPanel>
                            </Border>

                            <!-- Graph Editor Canvas -->
                            <timeline:GraphEditor x:Name="GraphEditor" />
                        </DockPanel>
                    </Border>
                </Grid>
            </Border>
        </Grid>
    </DockPanel>
</Window>
